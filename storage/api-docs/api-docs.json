{
    "openapi": "3.0.0",
    "info": {
        "title": "Leave Management API",
        "description": "A comprehensive Leave Management API with role-based access control for managing employee leave requests, approvals, and leave balance tracking.",
        "contact": {
            "email": "support@leavemanagement.com"
        },
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://localhost:8000/api",
            "description": "Local Development Server"
        }
    ],
    "paths": {
        "/auth/register": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Register a new user",
                "description": "Create a new user account. Default role is 'general'. Admin and HR roles can only be assigned by administrators.",
                "operationId": "c47a1b563e5e8bc3c7b962f893981e84",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name",
                                    "email",
                                    "password",
                                    "password_confirmation"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "John Doe"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "john@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "minLength": 8,
                                        "example": "password123"
                                    },
                                    "password_confirmation": {
                                        "type": "string",
                                        "format": "password",
                                        "example": "password123"
                                    },
                                    "role": {
                                        "description": "User role (default: general)",
                                        "type": "string",
                                        "enum": [
                                            "general",
                                            "hr",
                                            "admin"
                                        ],
                                        "example": "general"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "User registered successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "User registered successfully"
                                        },
                                        "data": {
                                            "properties": {
                                                "user": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "integer",
                                                            "example": 1
                                                        },
                                                        "name": {
                                                            "type": "string",
                                                            "example": "John Doe"
                                                        },
                                                        "email": {
                                                            "type": "string",
                                                            "example": "john@example.com"
                                                        },
                                                        "role": {
                                                            "type": "string",
                                                            "example": "general"
                                                        },
                                                        "annual_leave_entitlement": {
                                                            "type": "integer",
                                                            "example": 30
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "token": {
                                                    "type": "string",
                                                    "example": "1|abcdef123456..."
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Validation error"
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/login": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Login user",
                "description": "Authenticate user and receive access token",
                "operationId": "1ff9c65c5cd1a8e0786e318eed856972",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email",
                                    "password"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "john@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "example": "password123"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Login successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Login successful"
                                        },
                                        "data": {
                                            "properties": {
                                                "user": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "integer",
                                                            "example": 1
                                                        },
                                                        "name": {
                                                            "type": "string",
                                                            "example": "John Doe"
                                                        },
                                                        "email": {
                                                            "type": "string",
                                                            "example": "john@example.com"
                                                        },
                                                        "role": {
                                                            "type": "string",
                                                            "example": "general"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "token": {
                                                    "type": "string",
                                                    "example": "1|abcdef123456..."
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid credentials",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Invalid credentials"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/logout": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Logout user",
                "description": "Revoke the current access token",
                "operationId": "eae6a8251a6469bbabe454860f64cf37",
                "responses": {
                    "200": {
                        "description": "Logout successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Logout successful"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Unauthenticated."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/auth/me": {
            "get": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Get current user",
                "description": "Retrieve authenticated user information",
                "operationId": "257a57ee6760f86fb4b11ff94dba1f38",
                "responses": {
                    "200": {
                        "description": "User information retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "name": {
                                                    "type": "string",
                                                    "example": "John Doe"
                                                },
                                                "email": {
                                                    "type": "string",
                                                    "example": "john@example.com"
                                                },
                                                "role": {
                                                    "type": "string",
                                                    "example": "general"
                                                },
                                                "annual_leave_entitlement": {
                                                    "type": "integer",
                                                    "example": 30
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/leave-balance": {
            "get": {
                "tags": [
                    "Leave Balance"
                ],
                "summary": "Get leave balance",
                "description": "Retrieve the leave balance for the authenticated user, including total entitlement, used days, and remaining balance. HR and Admin can check other users' balance by providing user_id parameter.",
                "operationId": "b40dc33ddf224d9708a365b42c3a5b5b",
                "parameters": [
                    {
                        "name": "user_id",
                        "in": "query",
                        "description": "User ID to check balance for (HR/Admin only)",
                        "required": false,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Leave balance retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "user_id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "user_name": {
                                                    "type": "string",
                                                    "example": "John Doe"
                                                },
                                                "annual_leave_entitlement": {
                                                    "type": "number",
                                                    "example": 30
                                                },
                                                "used_days": {
                                                    "type": "number",
                                                    "example": 12.5
                                                },
                                                "remaining_days": {
                                                    "type": "number",
                                                    "example": 17.5
                                                },
                                                "pending_requests_days": {
                                                    "description": "Days in pending leave requests",
                                                    "type": "number",
                                                    "example": 2
                                                },
                                                "breakdown": {
                                                    "properties": {
                                                        "approved_leaves": {
                                                            "description": "Number of approved leave requests",
                                                            "type": "integer",
                                                            "example": 5
                                                        },
                                                        "pending_leaves": {
                                                            "description": "Number of pending leave requests",
                                                            "type": "integer",
                                                            "example": 1
                                                        },
                                                        "rejected_leaves": {
                                                            "description": "Number of rejected leave requests",
                                                            "type": "integer",
                                                            "example": 0
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    },
                    "403": {
                        "description": "Unauthorized - General users can only view their own balance"
                    },
                    "404": {
                        "description": "User not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/leave-balance/all": {
            "get": {
                "tags": [
                    "Leave Balance"
                ],
                "summary": "Get all users' leave balance summary",
                "description": "Retrieve leave balance summary for all users. Only accessible by HR and Admin roles.",
                "operationId": "b5329cfc1bbeca19552acf2b4a518948",
                "parameters": [
                    {
                        "name": "role",
                        "in": "query",
                        "description": "Filter by user role",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "general",
                                "hr",
                                "admin"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Leave balance summary retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "user_id": {
                                                        "type": "integer",
                                                        "example": 1
                                                    },
                                                    "user_name": {
                                                        "type": "string",
                                                        "example": "John Doe"
                                                    },
                                                    "user_role": {
                                                        "type": "string",
                                                        "example": "general"
                                                    },
                                                    "annual_leave_entitlement": {
                                                        "type": "number",
                                                        "example": 30
                                                    },
                                                    "used_days": {
                                                        "type": "number",
                                                        "example": 12.5
                                                    },
                                                    "remaining_days": {
                                                        "type": "number",
                                                        "example": 17.5
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Unauthorized - Only HR and Admin can access this endpoint"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/leave-requests": {
            "get": {
                "tags": [
                    "Leave Requests"
                ],
                "summary": "Get leave requests",
                "description": "Retrieve leave requests. General users see only their own requests. HR and Admin can see all requests. Supports filtering and pagination.",
                "operationId": "2975f455473a280798ba0919381c37f1",
                "parameters": [
                    {
                        "name": "status",
                        "in": "query",
                        "description": "Filter by status",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "pending",
                                "approved",
                                "rejected"
                            ]
                        }
                    },
                    {
                        "name": "user_id",
                        "in": "query",
                        "description": "Filter by user ID (HR/Admin only)",
                        "required": false,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "per_page",
                        "in": "query",
                        "description": "Number of items per page",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "default": 15
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Page number",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "default": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Leave requests retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "current_page": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "data": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "integer",
                                                                "example": 1
                                                            },
                                                            "leave_type": {
                                                                "type": "string",
                                                                "example": "full_day"
                                                            },
                                                            "start_date": {
                                                                "type": "string",
                                                                "example": "2026-01-20"
                                                            },
                                                            "end_date": {
                                                                "type": "string",
                                                                "example": "2026-01-20"
                                                            },
                                                            "status": {
                                                                "type": "string",
                                                                "example": "pending"
                                                            },
                                                            "days_count": {
                                                                "type": "number",
                                                                "example": 1
                                                            },
                                                            "user": {
                                                                "properties": {
                                                                    "id": {
                                                                        "type": "integer",
                                                                        "example": 1
                                                                    },
                                                                    "name": {
                                                                        "type": "string",
                                                                        "example": "John Doe"
                                                                    },
                                                                    "email": {
                                                                        "type": "string",
                                                                        "example": "john@example.com"
                                                                    }
                                                                },
                                                                "type": "object"
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                },
                                                "per_page": {
                                                    "type": "integer",
                                                    "example": 15
                                                },
                                                "total": {
                                                    "type": "integer",
                                                    "example": 50
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Leave Requests"
                ],
                "summary": "Submit a new leave request",
                "description": "Create a new leave request. The request will be automatically routed for approval based on user role (General -> HR, HR -> Admin, Admin -> Auto-approved)",
                "operationId": "5dab2409b62d4f909347c3aa22404ed5",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "leave_type",
                                    "start_date",
                                    "reason"
                                ],
                                "properties": {
                                    "leave_type": {
                                        "description": "Type of leave request",
                                        "type": "string",
                                        "enum": [
                                            "full_day",
                                            "half_day",
                                            "multi_day"
                                        ],
                                        "example": "full_day"
                                    },
                                    "start_date": {
                                        "description": "Start date of leave (must be today or future)",
                                        "type": "string",
                                        "format": "date",
                                        "example": "2026-01-20"
                                    },
                                    "end_date": {
                                        "description": "End date (required for multi_day, optional for others)",
                                        "type": "string",
                                        "format": "date",
                                        "example": "2026-01-22"
                                    },
                                    "half_day_period": {
                                        "description": "Required for half_day leave type",
                                        "type": "string",
                                        "enum": [
                                            "first_half",
                                            "second_half"
                                        ],
                                        "example": "first_half"
                                    },
                                    "reason": {
                                        "description": "Reason for leave request",
                                        "type": "string",
                                        "maxLength": 1000,
                                        "minLength": 10,
                                        "example": "Family emergency"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Leave request submitted successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Leave request submitted successfully"
                                        },
                                        "data": {
                                            "properties": {
                                                "id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "leave_type": {
                                                    "type": "string",
                                                    "example": "full_day"
                                                },
                                                "start_date": {
                                                    "type": "string",
                                                    "example": "2026-01-20"
                                                },
                                                "end_date": {
                                                    "type": "string",
                                                    "example": "2026-01-20"
                                                },
                                                "status": {
                                                    "type": "string",
                                                    "example": "pending"
                                                },
                                                "days_count": {
                                                    "type": "number",
                                                    "example": 1
                                                },
                                                "reason": {
                                                    "type": "string",
                                                    "example": "Family emergency"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Validation error"
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/leave-requests/{id}": {
            "get": {
                "tags": [
                    "Leave Requests"
                ],
                "summary": "Get a specific leave request",
                "description": "Retrieve details of a specific leave request. General users can only view their own requests.",
                "operationId": "25fb1eb2f397b89937e6e5cae3e0b3c9",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Leave request ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Leave request retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "leave_type": {
                                                    "type": "string",
                                                    "example": "full_day"
                                                },
                                                "start_date": {
                                                    "type": "string",
                                                    "example": "2026-01-20"
                                                },
                                                "end_date": {
                                                    "type": "string",
                                                    "example": "2026-01-20"
                                                },
                                                "status": {
                                                    "type": "string",
                                                    "example": "approved"
                                                },
                                                "days_count": {
                                                    "type": "number",
                                                    "example": 1
                                                },
                                                "reason": {
                                                    "type": "string",
                                                    "example": "Family emergency"
                                                },
                                                "user": {
                                                    "type": "object"
                                                },
                                                "approver": {
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Unauthorized to view this leave request"
                    },
                    "404": {
                        "description": "Leave request not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/leave-requests/{id}/approve": {
            "post": {
                "tags": [
                    "Leave Requests"
                ],
                "summary": "Approve a leave request",
                "description": "Approve a pending leave request. HR can approve General user requests. Admin can approve HR requests. Admins cannot approve General user requests directly.",
                "operationId": "198e9fcdf7865f0509180e7ca3a38c78",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Leave request ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Leave request approved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Leave request approved successfully"
                                        },
                                        "data": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Leave already processed or invalid approval chain"
                    },
                    "403": {
                        "description": "Unauthorized - Insufficient permissions"
                    },
                    "404": {
                        "description": "Leave request not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/leave-requests/{id}/reject": {
            "post": {
                "tags": [
                    "Leave Requests"
                ],
                "summary": "Reject a leave request",
                "description": "Reject a pending leave request with a reason. Same approval hierarchy applies as approval.",
                "operationId": "b8a4c34ed3bcf8cb44c735415c0b9eec",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Leave request ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "rejection_reason"
                                ],
                                "properties": {
                                    "rejection_reason": {
                                        "type": "string",
                                        "maxLength": 500,
                                        "minLength": 10,
                                        "example": "Insufficient staffing during requested period"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Leave request rejected successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Leave request rejected"
                                        },
                                        "data": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Leave already processed"
                    },
                    "403": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Leave request not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        }
    },
    "components": {
        "securitySchemes": {
            "sanctum": {
                "type": "http",
                "description": "Enter your Bearer token in the format: Bearer {token}",
                "bearerFormat": "JWT",
                "scheme": "bearer"
            }
        }
    },
    "tags": [
        {
            "name": "Authentication",
            "description": "Authentication"
        },
        {
            "name": "Leave Balance",
            "description": "Leave Balance"
        },
        {
            "name": "Leave Requests",
            "description": "Leave Requests"
        }
    ]
}